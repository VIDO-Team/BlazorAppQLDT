@page "/CD18detail"
@page "/CD18detail/{id:int}"
@using BlazorAppQLDT.Shared
@inject ISinhvienCD18Service SinhvienServices
@inject NavigationManager NavigationManager
@if (Id == null)
{
    <PageTitle>Create a new student</PageTitle>
    <h3>Create a new student</h3>
}
else
{
    <PageTitle>Edit @student.Hoten</PageTitle>
    <h3>Edit @student.Hoten</h3>
}
<EditForm Model="student" OnSubmit="HandleSubmit">
    <div>
        <label for="tinh">Tỉnh</label>
        <InputText id="tinh" @bind-Value="student.Tinh" class="form-control"></InputText>
    </div>
    <div>
        <label for="hoten">Tên học sinh</label>
        <InputText id="hoten" @bind-Value="student.Hoten" class="form-control"></InputText>
    </div>
    <div>
        <label for="Ngaysinh">Ngày sinh</label>
        <InputNumber id="ngaysinh" @bind-Value="student.Ngaysinh" class="form-control"></InputNumber>
    </div>
    <div>
        <label for="Thangsinh">Tháng sinh</label>
        <InputNumber id="Thangsinh" @bind-Value="student.Thangsinh" class="form-control"></InputNumber>
    </div>
    <div>
        <label for="Namsinh">Năm sinh</label>
        <InputNumber id="Namsinh" @bind-Value="student.Namsinh" class="form-control"></InputNumber>
    </div>
    <div>
        <label for="IdNumber">Id Number</label>
        <InputText id="IdNumber" @bind-Value="student.IdNumber" class="form-control"></InputText>
    </div>
    <div>
        <label for="Truong">Trường</label>
        <InputText id="Truong" @bind-Value="student.Truong" class="form-control"></InputText>
    </div>
    <div>
        <label for="Lop">Lớp</label>
        <InputText id="Lop" @bind-Value="student.Lop" class="form-control"></InputText>
    </div>
    <div>
        <label for="Sodienthoai">Số điện thoại</label>
        <InputText id="Sodienthoai" @bind-Value="student.Sodienthoai" class="form-control"></InputText>
    </div>
    <div>
        <label for="Status">Status</label>
        <InputNumber id="Status" @bind-Value="student.Status" class="form-control"></InputNumber>
    </div>
    
    <br />
    <button type="submit" class="btn btn-primary">@btnText</button>
    <button type="button" class="btn btn-danger" @onclick="DeleteSinhvien">Delete</button>
    <button type="button" class="btn btn-danger" @onclick="Cancel">Cancel</button>
</EditForm>
@code {
    [Parameter]
    public int? Id { get; set; }

    string btnText = string.Empty;

    SinhvienCD18Model student = new SinhvienCD18Model();
    
    protected override async Task OnInitializedAsync()
    {
        btnText = Id == null ? "Save" : "Update";
    }

    protected override async Task OnParametersSetAsync()
    {
        if (Id != null)
        {
            student = await SinhvienServices.GetSingleSinhvien((int)Id);
        }
       
        
    }

    async Task HandleSubmit()
    {
        if (Id == null)
        {
            await SinhvienServices.CreateSinhvien(student);
        }
        else
        {
            await SinhvienServices.UpdateSinhvien(student);
        }
    }

    async Task DeleteSinhvien()
    {
        await SinhvienServices.DeleteSinhvien(student.Id);
    }
    async Task Cancel()
    {
        NavigationManager.NavigateTo("/CD18");
    }
}