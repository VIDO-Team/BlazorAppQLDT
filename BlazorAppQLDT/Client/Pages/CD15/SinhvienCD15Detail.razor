@page "/CD15detail"
@page "/CD15detail/{id:int}"
@using BlazorAppQLDT.Shared
@inject ISinhvienCD15Service SinhvienServices
@inject NavigationManager NavigationManager
@if (Id == null)
{
    <PageTitle>Create a new student</PageTitle>
    <h3>Create a new student</h3>
}
else
{
    <PageTitle>Edit @student.HoTen</PageTitle>
    <h3>Edit @student.HoTen</h3>
}
<EditForm Model="student" OnSubmit="HandleSubmit">
    <div>
        <label for="tinh">Tỉnh</label>
        <InputText id="tinh" @bind-Value="student.Tinh" class="form-control"></InputText>
    </div>
    <div>
        <label for="hoten">Tên học sinh</label>
        <InputText id="hoten" @bind-Value="student.HoTen" class="form-control"></InputText>
    </div>
    <div>
        <label for="NgaySinh">Ngày sinh</label>
        <InputNumber id="NgaySinh" @bind-Value="student.NgaySinh" class="form-control"></InputNumber>
    </div>
    <div>
        <label for="ThangSinh">Tháng sinh</label>
        <InputNumber id="ThangSinh" @bind-Value="student.ThangSinh" class="form-control"></InputNumber>
    </div>
    <div>
        <label for="NamSinh">Năm sinh</label>
        <InputNumber id="NamSinh" @bind-Value="student.NamSinh" class="form-control"></InputNumber>
    </div>
    <div>
        <label for="IdNumber">Id Number</label>
        <InputText id="IdNumber" @bind-Value="student.IdNumber" class="form-control"></InputText>
    </div>
    <div>
        <label for="Truong">Trường</label>
        <InputText id="Truong" @bind-Value="student.Truong" class="form-control"></InputText>
    </div>
    <div>
        <label for="Lop">Lớp</label>
        <InputText id="Lop" @bind-Value="student.Lop" class="form-control"></InputText>
    </div>
    <div>
        <label for="SoDienThoai">Số điện thoại</label>
        <InputText id="SoDienThoai" @bind-Value="student.SoDienThoai" class="form-control"></InputText>
    </div>
    <div>
        <label for="Status">Status</label>
        <InputNumber id="Status" @bind-Value="student.Status" class="form-control"></InputNumber>
    </div>
    <div>
        <label for="updateddatetime">UpdateDateTime</label>
        <InputDate id="updateddatetime" @bind-Value="student.UpdatedDateTime" class="form-control"></InputDate>
    </div>
    <div>
        <label for="responseStatus">ResponseStatus</label>
        <InputText id="responseStatus" @bind-Value="student.ResponseStatus" class="form-control"></InputText>
    </div>
    
    <br />
    <button type="submit" class="btn btn-primary">@btnText</button>
    <button type="button" class="btn btn-danger" @onclick="DeleteSinhvien">Delete</button>
    <button type="button" class="btn btn-danger" @onclick="Cancel">Cancel</button>
</EditForm>
@code {
    [Parameter]
    public int? Id { get; set; }

    string btnText = string.Empty;
    SinhvienCD15Model student = new SinhvienCD15Model();
    
    protected override async Task OnInitializedAsync()
    {
        btnText = Id == null ? "Save" : "Update";
    }

    protected override async Task OnParametersSetAsync()
    {
        if (Id != null)
        {
            student = await SinhvienServices.GetSingleSinhvien((int)Id);
        }
       
        
    }

    async Task HandleSubmit()
    {
        if (Id == null)
        {
            await SinhvienServices.CreateSinhvien(student);
        }
        else
        {
            await SinhvienServices.UpdateSinhvien(student);
        }
    }

    async Task DeleteSinhvien()
    {
        await SinhvienServices.DeleteSinhvien(student.Id);
    }
    async Task Cancel()
    {
        NavigationManager.NavigateTo("/CD15");
    }
}